---
description: 렌더링 최적화 작업 가이드 및 규칙
globs: ["src/**", "mockdowns/**"]
alwaysApply: false
---

# 🚀 렌더링 최적화 작업 가이드

> 📎 **연동 규칙**:
> - `global-rules.mdc` - 전역 규칙 (항상 적용)
> - `agent-selector.mdc` - Agent 자동 선택

---

## 📋 작업 목표

**2025년 기준 현업 FE 개발자 수준의 렌더링 최적화**

- 불필요한 리렌더링 방지
- 메모이제이션 적절한 활용
- 함수형 업데이트로 객체 생성 최소화
- 안정적인 key 사용

---

## 🎯 핵심 원칙

### ✅ DO (해야 할 것)

1. **기능 유지**
   - 모든 기능이 정상 작동해야 함
   - 검색, 드래그 앤 드롭, 스케줄 추가/삭제 등

2. **디자인 유지**
   - 레이아웃, 색상, 스타일 모두 동일
   - UI 변경 없음

3. **렌더링 최적화**
   - `useMemo`, `useCallback` 적절한 사용
   - 함수형 업데이트 활용
   - 안정적인 key 사용

### ❌ DON'T (하지 말아야 할 것)

1. **기능 변경 금지**
   - 동작 방식 변경 X
   - 새로운 기능 추가 X

2. **디자인 변경 금지**
   - UI 스타일 변경 X
   - 레이아웃 변경 X

3. **과도한 최적화 금지**
   - 불필요한 메모이제이션 X
   - 가독성을 해치는 최적화 X

---

## 📁 작업 계획 문서

**위치**: `mockdowns/렌더링-최적화-작업계획.md`

**내용**:
- 프로젝트 분석 요약
- 발견된 렌더링 이슈
- 최적화 작업 계획 (Phase별)
- 주의사항 및 검증 방법

---

## 🔍 작업 전 확인사항

### 필수 확인

1. **작업 계획 확인**
   ```
   mockdowns/렌더링-최적화-작업계획.md 읽기
   ```

2. **현재 상태 파악**
   ```
   - 어떤 컴포넌트가 문제인가?
   - 어떤 부분이 최적화 대상인가?
   - 예상 효과는 무엇인가?
   ```

3. **영향 범위 파악**
   ```
   - 수정 시 다른 컴포넌트에 영향이 있는가?
   - 기능이 변경될 위험이 있는가?
   - 디자인이 변경될 위험이 있는가?
   ```

---

## 🛠️ 최적화 작업 절차

### 1단계: 안전한 최적화 (먼저 진행)

```
1. key 안정화
2. 간단한 메모이제이션
3. 함수형 업데이트
```

### 2단계: 상태 업데이트 최적화

```
1. 객체 스프레드 → 함수형 업데이트
2. 불필요한 객체 생성 방지
```

### 3단계: 계산 최적화

```
1. useMemo로 계산 결과 캐싱
2. useCallback으로 함수 메모이제이션
```

### 4단계: 검증

```
1. 기능 테스트
2. UI 확인
3. 성능 측정 (React DevTools Profiler)
```

---

## 📋 작업 체크리스트

### 작업 전

- [ ] 작업 계획 문서 확인
- [ ] 현재 코드 분석
- [ ] 영향 범위 파악
- [ ] 기능/디자인 변경 위험 확인

### 작업 중

- [ ] 기능이 정상 작동하는지 확인
- [ ] UI가 변경되지 않았는지 확인
- [ ] 최소한의 수정만 수행
- [ ] 불필요한 변경 없음 확인

### 작업 후

- [ ] 모든 기능 테스트
- [ ] UI 확인
- [ ] React DevTools Profiler로 성능 확인
- [ ] 불필요한 리렌더링 감소 확인

---

## 🧪 검증 방법

### 1. 기능 테스트

```bash
# 개발 서버 실행
npm run dev

# 수동 테스트
- 검색 다이얼로그 열기/닫기
- 검색어 입력 및 필터링
- 학년, 요일, 시간, 전공 필터 선택
- 스크롤하여 페이지네이션 확인
- 스케줄 추가
- 드래그 앤 드롭으로 스케줄 이동
- 스케줄 삭제
- 테이블 복제/삭제
```

### 2. UI 확인

- [ ] 레이아웃이 변경되지 않았는가?
- [ ] 색상이 올바르게 표시되는가?
- [ ] 모달이 정상적으로 열리고 닫히는가?
- [ ] 테이블이 올바르게 렌더링되는가?

### 3. 성능 측정

**React DevTools Profiler 사용**:

```bash
# 개발 모드에서 실행
npm run dev

# React DevTools 설치 후 Profiler 탭 사용
# 1. "Record" 버튼 클릭
# 2. 주요 동작 수행 (검색, 드래그, 필터링 등)
# 3. "Stop" 버튼 클릭
# 4. 렌더링 시간 및 횟수 확인
```

---

## 🚨 문제 발생 시

다음 상황이 발생하면 **즉시 중단하고 보고**:

1. ❌ 기능이 작동하지 않음
2. ❌ UI가 변경됨
3. ❌ 타입 에러가 해결되지 않음
4. ❌ 예상치 못한 부작용 발생
5. ❌ 성능이 오히려 저하됨

---

## 💡 주요 최적화 기법

### 1. 함수형 업데이트

```typescript
// ❌ 나쁜 예: 매번 새 객체 생성
setState({ ...state, field: value });

// ✅ 좋은 예: 함수형 업데이트
setState((prev) => ({ ...prev, field: value }));
```

### 2. useMemo 활용

```typescript
// ❌ 나쁜 예: 매번 재계산
const result = expensiveCalculation(data);

// ✅ 좋은 예: 메모이제이션
const result = useMemo(
  () => expensiveCalculation(data),
  [data]
);
```

### 3. 안정적인 key 사용

```typescript
// ❌ 나쁜 예: 불안정한 key
key={`${item.title}-${index}`}

// ✅ 좋은 예: 안정적인 key
key={`${item.id}-${index}`}
// 또는
key={item.id}
```

### 4. useCallback 활용

```typescript
// ❌ 나쁜 예: 매번 새 함수 생성
const handleClick = () => { /* ... */ };

// ✅ 좋은 예: 메모이제이션
const handleClick = useCallback(() => {
  /* ... */
}, [dependencies]);
```

---

## 📊 예상 효과

### 성능 개선 예상치

- **불필요한 리렌더링**: 30-50% 감소 예상
- **메모리 사용량**: 10-20% 감소 예상
- **렌더링 시간**: 20-30% 개선 예상

### 주요 개선 포인트

1. 검색 옵션 변경 시 리렌더링 최소화
2. 드래그 앤 드롭 시 전체 리렌더링 방지
3. 필터링 계산 최적화
4. 색상 계산 최적화

---

## 🎯 이 프로젝트 핵심 정보

### 프로젝트 목표

> FE 개발자가 **"React 렌더링 최적화를 이해하고 적용할 수 있는지"** 확인

### 핵심 질문 3가지

1. 어떤 부분이 불필요하게 리렌더링되는가?
2. 어떻게 메모이제이션을 활용할 수 있는가?
3. 함수형 업데이트로 객체 생성을 어떻게 최소화할 수 있는가?

### 작업 순서

```
Phase 1: 안전한 최적화 (key, 간단한 메모이제이션)
    ↓
Phase 2: 상태 업데이트 최적화 (함수형 업데이트)
    ↓
Phase 3: 계산 최적화 (useMemo, useCallback)
    ↓
Phase 4: 검증 및 확인
```

> 💡 **최소한의 수정으로 최대 효과 달성**
> ⚠️ **기능과 디자인은 절대 변경하지 않음**
