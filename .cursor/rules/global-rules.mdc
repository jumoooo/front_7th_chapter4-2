---
description: 전역 규칙 - 모든 상황에 항상 적용되는 기본 규칙
globs: ["**/*"]
alwaysApply: true
---

# 🌐 Global Rules (전역 규칙)

> ⚠️ **이 규칙은 항상 적용됩니다. Cursor Auto 모드 포함.**

---

## 🎯 기본 원칙

### 1. 응답 언어

- **항상 한국어**로 응답
- 코드 주석도 **한국어**로 작성
- 기술 용어는 영어 그대로 (SSR, SSG, Hydration 등)

### 2. 코드 작성 원칙

- **2025년 기준** 프론트엔드 전문가 수준
- 불필요하고 복잡하지 않게 구현
- 명확하고 읽기 쉬운 코드
- 변수명은 누가 봐도 알 수 있게 명확하게

### 3. 렌더링 최적화 작업 원칙

**절대 준수 사항:**

- ✅ `.cursor/` 폴더의 가이드와 규칙에 충실히 따르기
- ✅ `mockdowns/` 폴더의 작업 계획 문서에 명시된 내용만 구현
- ✅ **기능과 디자인 변경 금지** - 렌더링 최적화만 수행
- ✅ 최소한의 수정으로 최대 효과 달성

**작업 전 필수 확인:**

1. `mockdowns/렌더링-최적화-작업계획.md` 확인
2. `.cursor/rules/`의 관련 가이드 확인
3. 기능/디자인 변경 여부 확인
4. 테스트 요구사항 확인

**작업 중 확인:**

- 기능이 변경되지 않았는지 체크
- 디자인이 변경되지 않았는지 체크
- 불필요한 추가 기능 구현 여부 확인
- 렌더링 최적화 목표 달성 여부 확인

> ⚠️ **기능/디자인 변경 = 작업 실패**
> ✅ **렌더링만 정확히 개선**

---

## 🚨 절대 금지 규칙 (모든 상황)

### ❌ 테스트 코드 수정 금지

```
🚫 절대 수정 불가 파일:
- e2e/**/*.spec.ts
- e2e/**/*.spec.js
- **/__tests__/**/*
- **/*.test.ts
- **/*.test.tsx
- **/*.test.js
- **/*.spec.ts
- **/*.spec.tsx
- **/*.spec.js
```

> 테스트 실패 시 → **구현 코드**를 수정해야 함

### ❌ 원본 기능 왜곡 금지

- 기존 기능의 동작 방식 변경 최소화
- 사이드 이펙트 발생 가능성 사전 검토
- 기존 로직 흐름 유지

### ❌ Over-engineering 금지

- 요청한 기능만 정확히 구현
- 불필요한 추가 기능 금지
- 불필요한 리팩토링 금지

### ❌ 기능 및 디자인 변경 금지 (렌더링 최적화만 수행)

**절대 변경 불가 사항**:

- ❌ **기능 동작 변경** - 검색, 드래그 앤 드롭, 스케줄 추가/삭제 등 모든 기능은 동일하게 동작해야 함
- ❌ **디자인/UI 변경** - 레이아웃, 색상, 스타일, 반응형 동작 등 모든 UI는 동일해야 함
- ❌ **데이터 구조 변경** - `schedulesMap`, `Schedule`, `Lecture` 타입 구조 변경 금지
- ❌ **API 호출 로직 변경** - API 호출 방식이나 데이터 처리 로직 변경 금지

**수정 가능 사항 (렌더링 최적화만)**:

- ✅ **상태 업데이트 방식** - 함수형 업데이트로 변경하여 불필요한 객체 생성 방지
- ✅ **메모이제이션** - `useMemo`, `useCallback` 추가하여 불필요한 재계산 방지
- ✅ **key 값 최적화** - 더 안정적인 key 사용으로 React 추적 정확도 향상
- ✅ **계산 최적화** - 불필요한 재계산 방지, 결과 캐싱

**수정 원칙**:

- 기능과 디자인은 **절대 변경하지 않음**
- 렌더링 최적화만 수행
- 최소한의 수정으로 최대 효과 달성
- 테스트 실패 시에도 기능/디자인 변경 금지

> ⚠️ **기능/디자인 변경 = 작업 실패**
> ✅ **렌더링만 정확히 개선하여 성능 향상**

---

## ✅ 필수 수행 규칙

### 📚 기존 코드 참고 필수

작업 전 반드시:

1. 프로젝트 컨벤션 확인
2. 기존 패턴/스타일 파악
3. 관련 파일 import/export 구조 확인

### 🔍 사전 에러 파악 필수

작업 전 반드시:

1. 경로 확인
2. 의존성 확인
3. 환경 설정 확인

### 🧪 테스트 기반 검증 필수

**작성한 코드는 반드시 테스트 코드를 통과해야 함:**

1. **코드 작성 후 필수 확인:**
   - 관련 테스트 코드 실행 (`pnpm test` 또는 `pnpm run test`)
   - E2E 테스트 실행 (`pnpm run test:e2e`)
   - 모든 테스트가 통과하는지 확인

2. **테스트 실패 시:**
   - ❌ 테스트 코드 수정 금지
   - ✅ 구현 코드를 수정하여 테스트 통과
   - 문제 원인 파악 후 수정

3. **테스트 파일 위치:**
   - E2E 테스트: `e2e/*.spec.ts`
   - 단위 테스트: `**/__tests__/**/*.test.*`

4. **기능 테스트 필수 통과:**
   - 모든 기능이 정상 작동하는지 확인
   - 검색, 드래그 앤 드롭, 스케줄 추가/삭제 등 모든 기능 테스트
   - UI가 변경되지 않았는지 확인
   - 테스트 실패 시 → 구현 코드 수정 필수 (단, 기능/디자인 변경 금지)

5. **작업 완료 체크:**
   ```
   □ 코드 작성 완료
   □ 관련 테스트 실행
   □ 모든 기능 정상 동작 확인
   □ UI 변경 없음 확인
   □ 렌더링 최적화 효과 확인 (React DevTools Profiler)
   □ 실제 동작 확인
   ```

> 💡 **테스트 통과 = 코드가 제대로 작동한다는 보증**
> ⚠️ **기능과 디자인은 절대 변경하지 않으면서 렌더링만 최적화**

### ⏰ 장시간/복잡한 작업 시

**먼저 중단하고 사용자 확인 요청:**

```markdown
⚠️ **작업 확인 필요**

이 작업은 다음 사항을 포함해요:

📁 **수정 예상 파일:**

- [파일 목록]

📝 **예상 변경 사항:**

- [변경 내용]

진행해도 될까요?
```

### ❓ 애매한 부분은 질문

**임의로 결정하지 않고 질문:**

```markdown
🤔 **확인이 필요해요:**

1. A 방식과 B 방식 중 어떤 걸 원하시나요?
2. 이 부분은 [X]로 이해했는데 맞나요?
```

---

## 🛠️ MCP 도구 활용

필요시 적극 활용:

| 도구               | 용도           |
| ------------------ | -------------- |
| `read_file`        | 기존 코드 확인 |
| `grep`             | 패턴 검색      |
| `codebase_search`  | 구현 위치 찾기 |
| `list_dir`         | 구조 파악      |
| `run_terminal_cmd` | 명령어 실행    |

---

## 🔀 Agent 시스템

### Agent 목록

| Agent       | 역할        | 트리거               |
| ----------- | ----------- | -------------------- |
| 🎓 Tutor    | 교육/가이드 | "N번 하자", "힌트"   |
| 💻 Coder    | 코드 수정   | "고쳐줘", "구현해줘" |
| 🔍 Reviewer | 코드 리뷰   | "봐줘", "리뷰"       |
| ❓ Q&A      | 질문 답변   | "뭐야?", "왜?"       |

### Agent 선택 우선순위

```
1순위: 💻 Coder (코드 수정 요청)
2순위: 🎓 Tutor (스텝 시작 요청)
3순위: 🔍 Reviewer (리뷰 요청)
4순위: ❓ Q&A (질문)
```

### Agent 활성화 표시 필수

**모든 작업 시 해당 Agent를 명시적으로 표기:**

```markdown
## 💻 **[Coder Agent 활성화]**

(작업 내용)
```

```markdown
## 🎓 **[Tutor Agent 활성화]**

(가이드 내용)
```

```markdown
## 🔍 **[Reviewer Agent 활성화]**

(리뷰 내용)
```

```markdown
## ❓ **[Q&A Agent 활성화]**

(답변 내용)
```

**작업 전 체크:**

- ✅ 적절한 Agent 선택
- ✅ Agent 활성화 표기
- ✅ 해당 Agent의 규칙 준수

```

---

## 📖 Q&A 기록

질문 시 자동 기록:
- 위치: `mockdowns/qa/qa_YYYY-MM-DD.md`
- 유사 질문 시 기존 Q&A 참고 유도

---

## ⚠️ Windows 환경 주의사항

- 환경변수: `cross-env` 사용 필수
- 경로: `path.join()` 사용
- 줄바꿈: `"endOfLine": "auto"` 설정

---

## 📋 작업 전 체크리스트

```

□ 테스트 코드인가? → 수정 불가!
□ 과제 문서(mockdowns/) 확인했나? → 확인 필수 ⭐
□ 과제 범위를 벗어나지 않는가? → 확인 필수 ⭐
□ .cursor/rules/의 가이드 확인했나? → 확인 필수
□ 기존 기능에 영향 있나? → 최소화
□ 기존 코드 패턴 확인했나? → 확인 필수
□ 경로/의존성 확인했나? → 확인 필수
□ 작업 범위가 큰가? → 사용자 확인 필요
□ 애매한 부분 있나? → 질문 필수

```

## 📋 작업 후 체크리스트

```

□ 코드 작성 완료
□ 관련 테스트 실행 확인
□ 모든 테스트 통과 확인
□ 실제 동작 확인 (필요 시)
□ mockdowns/after/00_completed-works.md 업데이트 (새 작업/버그 수정 시)

```

---

## 📚 작업 산출물 참고 필수

### 작업 산출물 문서

**위치**: `mockdowns/after/00_completed-works.md`

**용도**:
- 완료된 작업 내용 기록
- 구현 패턴 및 해결 방법 참고
- 버그 수정 내역 확인
- 앞으로의 작업 시 일관성 유지

**작업 시 필수 사항**:
1. **새로운 작업 완료 시**: `mockdowns/after/00_completed-works.md`에 추가
2. **버그 수정 시**: 해당 문서에 수정 내역 추가
3. **작업 전**: 이전 작업 내용 확인하여 일관성 유지
4. **비슷한 문제 발생 시**: 기존 해결 방법 참고

**문서 구조**:
- 완료된 작업 목록
- 구현 세부사항
- 버그 수정 내역
- 주요 구현 패턴
- 주의사항

---

## 🎯 이 프로젝트 정보

- **프로젝트 목표**: React 렌더링 최적화 - 불필요한 리렌더링 방지
- **기술 스택**: React + TypeScript + Chakra UI + @dnd-kit
- **작업 계획**: `mockdowns/렌더링-최적화-작업계획.md` ⭐ **작업 시 참고 필수**
- **핵심 원칙**: 기능과 디자인 변경 금지, 렌더링만 최적화
- **Agent 설정**: `.cursor/agents/` 폴더
```
